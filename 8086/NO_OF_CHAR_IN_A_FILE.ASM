.MODEL SMALL

.STACK 100H

.DATA
	FILENAME DB 'TESTFILE.TXT'
	READVAL	 DB 20 DUP('$'), 0H
	NL	 DB 0DH, 0AH, '$'
	HANDLE 	 DW ?
.CODE
BEGIN:
	MOV AX, @DATA		; INITIALISE
	MOV DS, AX

	LEA DX, FILENAME
	MOV CX, 0H
	MOV AX, 3D00H		; OPEN IN READ ONLY MODE
	INT 21H
	MOV HANDLE, AX

	LEA DX, READVAL		
	MOV CX, 0FFFFH
	MOV BX, HANDLE
	MOV AX, 3F00H		; READ FROM FILE
	INT 21H

	LEA DX, READVAL		; PRINT READ FROM FILE
	MOV AH, 09H
	INT 21H	

	LEA DX, NL		; PRINT NEWLINE
	MOV AH, 09H
	INT 21H

	MOV BH, '$'		; COUNT THE NUMBER OF CHAR
	MOV AX, 0000H
	LEA SI, READVAL

DO:	MOV BL, [SI]
	CMP BL, BH
	JE DONE
	INC SI
	INC AX
	JNE DO

DONE:	CALL DISNUM

	MOV BX, HANDLE		; CLOSE FILE
	MOV AX, 3E00H		
	INT 21H

	MOV AH, 4CH		; RETURN
	INT 21H

DISNUM	PROC
	MOV BX, 10D
	MOV DX, 0000H
	MOV CX, 0000H

P1:	MOV DX, 0000H
	DIV BX
	PUSH DX
	INC CX
	CMP AX, 0H
	JNE P1

P2:	POP DX
	ADD DX, 30H
	MOV AH, 02H
	INT 21H
	LOOP P2
	RET
DISNUM	ENDP

END BEGIN
